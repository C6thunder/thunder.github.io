<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>个人笔记网站 - 我的笔记</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body data-theme="violet">
    <div class="background">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
        <div class="gradient-orb orb-3"></div>
        <div class="gradient-orb orb-4"></div>
        <div class="gradient-orb orb-5"></div>
    </div>
    <div class="particles" id="particles"></div>

    <!-- 主题切换器 -->
    <div class="theme-switcher">
        <button class="theme-toggle-btn" id="themeToggle" title="切换主题">
            <i class="fas fa-palette"></i>
        </button>
        <div class="theme-panel" id="themePanel">
            <h3><i class="fas fa-magic"></i> 选择主题</h3>
            <div class="theme-options">
                <div class="theme-option" data-theme="violet" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);" title="紫罗兰梦境">
                    <div class="theme-label">紫罗兰</div>
                </div>
                <div class="theme-option" data-theme="cyber" style="background: linear-gradient(135deg, #00f0ff 0%, #ff00ff 100%);" title="霓虹赛博">
                    <div class="theme-label">赛博</div>
                </div>
                <div class="theme-option" data-theme="minimal" style="background: linear-gradient(135deg, #ffffff 0%, #888888 100%);" title="极简黑白">
                    <div class="theme-label">极简</div>
                </div>
                <div class="theme-option" data-theme="sunset" style="background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);" title="日落暖阳">
                    <div class="theme-label">暖阳</div>
                </div>
                <div class="theme-option" data-theme="ocean" style="background: linear-gradient(135deg, #00bfff 0%, #1e90ff 100%);" title="深海幽蓝">
                    <div class="theme-label">深海</div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <header class="header">
            <div class="profile-section">
                <div class="avatar-container">
                    <img src="https://avatars.githubusercontent.com/u/000000?v=4" alt="个人头像" class="avatar" id="avatarImg">
                    <div class="avatar-ring"></div>
                </div>
                <h1 class="title">
                    <span class="title-gradient">我的个人笔记</span>
                </h1>
                <p class="subtitle" id="profileBio">分享知识，记录生活</p>
                <div class="profile-stats">
                    <div class="stat-item">
                        <i class="fas fa-sticky-note"></i>
                        <span id="noteCount">0</span>
                        <label>篇笔记</label>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-eye"></i>
                        <span id="viewCount">0</span>
                        <label>次阅读</label>
                    </div>
                </div>
            </div>
        </header>

        <div class="content-section">
            <!-- 搜索栏 -->
            <div class="search-container">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" placeholder="搜索笔记、标签或内容...">
                    <button class="search-btn" id="searchBtn">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>

            <!-- 快捷操作 -->
            <div class="quick-actions">
                <a href="notes.html" class="action-card">
                    <div class="action-icon">
                        <i class="fas fa-book"></i>
                    </div>
                    <div class="action-content">
                        <h3>所有笔记</h3>
                        <p>浏览所有笔记内容</p>
                    </div>
                    <i class="fas fa-chevron-right"></i>
                </a>

                <button class="action-card" id="randomNoteBtn">
                    <div class="action-icon">
                        <i class="fas fa-random"></i>
                    </div>
                    <div class="action-content">
                        <h3>随机笔记</h3>
                        <p>发现有趣的内容</p>
                    </div>
                    <i class="fas fa-chevron-right"></i>
                </button>

                <button class="action-card" id="recentNotesBtn">
                    <div class="action-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="action-content">
                        <h3>最近更新</h3>
                        <p>查看最新笔记</p>
                    </div>
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>

            <!-- 最近笔记 -->
            <div class="section-header">
                <h2><i class="fas fa-star"></i> 最近笔记</h2>
                <a href="notes.html" class="view-all">查看全部 <i class="fas fa-arrow-right"></i></a>
            </div>
            <div class="notes-grid" id="recentNotes">
                <div class="loading">加载中...</div>
            </div>

            <!-- 热门标签 -->
            <div class="section-header">
                <h2><i class="fas fa-tags"></i> 热门标签</h2>
            </div>
            <div class="tags-container" id="tagsContainer">
                <div class="loading">加载中...</div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>

    <!-- 粒子效果 -->
    <script>
        // 背景粒子效果
        function createBackgroundParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 30;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle bg-particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (20 + Math.random() * 10) + 's';
                particle.style.opacity = '0.2';
                particlesContainer.appendChild(particle);
            }
        }

        // 鼠标跟随粒子效果
        function initMouseFollowParticles() {
            const canvas = document.createElement('canvas');
            canvas.id = 'mouse-canvas';
            document.body.appendChild(canvas);

            const ctx = canvas.getContext('2d');
            const particles = [];
            const mouse = { x: 0, y: 0 };

            function resize() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
            resize();
            window.addEventListener('resize', resize);

            document.addEventListener('mousemove', (e) => {
                mouse.x = e.clientX;
                mouse.y = e.clientY;

                for (let i = 0; i < 5; i++) {
                    particles.push({
                        x: mouse.x,
                        y: mouse.y,
                        vx: (Math.random() - 0.5) * 2,
                        vy: (Math.random() - 0.5) * 2,
                        life: 1,
                        size: Math.random() * 3 + 2
                    });
                }
            });

            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                particles.forEach((particle, index) => {
                    particle.x += particle.vx;
                    particle.y += particle.vy;
                    particle.life -= 0.02;

                    if (particle.life <= 0) {
                        particles.splice(index, 1);
                        return;
                    }

                    const alpha = particle.life;
                    const gradient = ctx.createRadialGradient(
                        particle.x, particle.y, 0,
                        particle.x, particle.y, particle.size * 2
                    );
                    gradient.addColorStop(0, `rgba(102, 126, 234, ${alpha})`);
                    gradient.addColorStop(0.5, `rgba(240, 147, 251, ${alpha * 0.5})`);
                    gradient.addColorStop(1, 'rgba(0, 0, 0, 0)');

                    ctx.fillStyle = gradient;
                    ctx.beginPath();
                    ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                    ctx.fill();
                });

                requestAnimationFrame(animate);
            }

            animate();
        }

        // 搜索功能
        function initSearch() {
            const searchInput = document.getElementById('searchInput');
            const searchBtn = document.getElementById('searchBtn');

            function performSearch() {
                const query = searchInput.value.trim();
                if (query) {
                    window.location.href = `notes.html?search=${encodeURIComponent(query)}`;
                }
            }

            searchBtn.addEventListener('click', performSearch);
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });
        }

        // 加载笔记数据
        async function loadNotes() {
            try {
                // 从本地JSON文件加载笔记列表
                const response = await fetch('./notes/notes.json');
                const data = await response.json();

                // 更新统计
                document.getElementById('noteCount').textContent = data.notes.length;

                // 显示最近笔记（前3篇）
                const recentNotesContainer = document.getElementById('recentNotes');
                if (data.notes.length === 0) {
                    recentNotesContainer.innerHTML = '<div class="empty-state"><i class="fas fa-sticky-note"></i><p>暂无笔记</p></div>';
                } else {
                    const recentNotes = data.notes.slice(0, 3);
                    recentNotesContainer.innerHTML = recentNotes.map(note => `
                        <div class="note-card" onclick="location.href='note.html?id=${note.id}'">
                            <div class="note-header">
                                <h3>${note.title}</h3>
                                <span class="note-date">${note.date}</span>
                            </div>
                            <p class="note-excerpt">${note.excerpt}</p>
                            <div class="note-tags">
                                ${note.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                            </div>
                        </div>
                    `).join('');
                }

                // 提取所有标签
                const allTags = new Set();
                data.notes.forEach(note => {
                    note.tags.forEach(tag => allTags.add(tag));
                });

                // 显示标签（前10个）
                const tagsContainer = document.getElementById('tagsContainer');
                const topTags = Array.from(allTags).slice(0, 10);
                if (topTags.length === 0) {
                    tagsContainer.innerHTML = '<div class="empty-state"><i class="fas fa-tags"></i><p>暂无标签</p></div>';
                } else {
                    tagsContainer.innerHTML = topTags.map(tag => `
                        <span class="tag-cloud" onclick="location.href='notes.html?tag=${encodeURIComponent(tag)}'">
                            ${tag}
                        </span>
                    `).join('');
                }

            } catch (error) {
                console.error('加载笔记失败:', error);
                document.getElementById('recentNotes').innerHTML = '<div class="error-state"><i class="fas fa-exclamation-circle"></i><p>加载失败，请稍后重试</p></div>';
                document.getElementById('tagsContainer').innerHTML = '<div class="error-state"><i class="fas fa-exclamation-circle"></i><p>加载失败</p></div>';
            }
        }

        // 主题切换器
        function initThemeSwitcher() {
            const themeToggle = document.getElementById('themeToggle');
            const themePanel = document.getElementById('themePanel');
            const themeOptions = document.querySelectorAll('.theme-option');
            const body = document.body;

            const savedTheme = localStorage.getItem('theme') || 'violet';
            setTheme(savedTheme);

            themeToggle.addEventListener('click', (e) => {
                e.stopPropagation();
                themePanel.classList.toggle('open');
            });

            themeOptions.forEach(option => {
                option.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const theme = option.dataset.theme;
                    setTheme(theme);
                    themePanel.classList.remove('open');
                });
            });

            document.addEventListener('click', () => {
                themePanel.classList.remove('open');
            });

            function setTheme(theme) {
                body.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);

                themeOptions.forEach(opt => {
                    opt.classList.toggle('active', opt.dataset.theme === theme);
                });

                body.style.transition = 'background 0.5s ease';
                setTimeout(() => {
                    body.style.transition = '';
                }, 500);
            }
        }

        // 页面加载完成后初始化
        window.addEventListener('load', () => {
            createBackgroundParticles();
            initMouseFollowParticles();
            initSearch();
            loadNotes();
            initThemeSwitcher();
        });
    </script>
</body>

</html>
