<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠ å¯†Tokenä½¿ç”¨ç¤ºä¾‹</title>
    <style>
        body { font-family: 'Arial', sans-serif; max-width: 1000px; margin: 0 auto; padding: 20px; line-height: 1.6; }
        h1 { color: #333; border-bottom: 3px solid #667eea; padding-bottom: 10px; }
        h2 { color: #667eea; margin-top: 30px; }
        code { background: #f4f4f4; padding: 2px 6px; border-radius: 3px; font-family: 'Courier New', monospace; }
        pre { background: #2d2d2d; color: #f8f8f2; padding: 20px; border-radius: 5px; overflow-x: auto; }
        .step { background: #e8f4f8; padding: 15px; margin: 10px 0; border-left: 4px solid #667eea; }
        .warning { background: #fff3cd; color: #856404; padding: 15px; border: 1px solid #ffc107; border-radius: 5px; margin: 20px 0; }
        .success { background: #d4edda; color: #155724; padding: 15px; border: 1px solid #28a745; border-radius: 5px; margin: 20px 0; }
    </style>
</head>
<body>
    <h1>ğŸ” åŠ å¯†Tokenä½¿ç”¨æŒ‡å—</h1>

    <div class="warning">
        <h3>âš ï¸ é‡è¦å®‰å…¨æç¤º</h3>
        <p>æ­¤æ–¹æ¡ˆæä¾›äº†ä¸€ç§ä¾¿åˆ©çš„æ–¹å¼è®©ç”¨æˆ·åŒ¿åè¯„è®ºï¼Œä½†è¯·æ³¨æ„ï¼š</p>
        <ul>
            <li>æœ‰æŠ€æœ¯èƒ½åŠ›çš„ç”¨æˆ·å¯èƒ½é€šè¿‡é€†å‘å·¥ç¨‹è·å–token</li>
            <li>è¯·ç¡®ä¿tokenæƒé™ä»…é™è¯„è®ºç›®å½•</li>
            <li>å®šæœŸæ›´æ¢tokenå’Œå¯†ç </li>
            <li>ç›‘æ§tokenä½¿ç”¨æƒ…å†µ</li>
        </ul>
    </div>

    <h2>ğŸ“‹ ä½¿ç”¨æ­¥éª¤</h2>

    <div class="step">
        <h3>æ­¥éª¤ 1: ç”ŸæˆåŠ å¯†token</h3>
        <p>åœ¨æœ¬åœ°è¿è¡ŒåŠ å¯†è„šæœ¬ï¼š</p>
        <pre><code>python3 .local_encrypt.py</code></pre>
        <p>æŒ‰æç¤ºè¾“å…¥ï¼š</p>
        <ul>
            <li>æ‚¨çš„GitHub Fine-grained token</li>
            <li>åŠ å¯†å¯†ç ï¼ˆè®°ä½è¿™ä¸ªå¯†ç ï¼‰</li>
        </ul>
        <p>è„šæœ¬ä¼šè¾“å‡ºåŠ å¯†åçš„é…ç½®ä»£ç ã€‚</p>
    </div>

    <div class="step">
        <h3>æ­¥éª¤ 2: å°†åŠ å¯†é…ç½®æ·»åŠ åˆ°ç½‘ç«™</h3>
        <p>åœ¨ä»»æ„HTMLé¡µé¢ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š</p>
        <pre><code>&lt;script&gt;
// åŠ å¯†tokené…ç½®ï¼ˆæ¥è‡ªæ­¥éª¤1çš„è¾“å‡ºï¼‰
window.setupEncryptedToken({
    token: "åŠ å¯†çš„tokenæ•°æ®",
    salt: "åŠ å¯†çš„ç›å€¼",
    iterations: 100000
});
&lt;/script&gt;</code></pre>
    </div>

    <div class="step">
        <h3>æ­¥éª¤ 3: ç›‘å¬tokenåŠ è½½å®Œæˆ</h3>
        <p>åœ¨éœ€è¦ä½¿ç”¨tokençš„åœ°æ–¹ç›‘å¬äº‹ä»¶ï¼š</p>
        <pre><code>// æ–¹å¼1: äº‹ä»¶ç›‘å¬
window.addEventListener('tokenLoaded', () => {
    console.log('Tokenå·²åŠ è½½ï¼Œå¯ä»¥è¿›è¡Œè¯„è®º');
    // å¯ç”¨è¯„è®ºè¡¨å•
    document.getElementById('commentForm').disabled = false;
});

// æ–¹å¼2: æ‰‹åŠ¨æ£€æŸ¥
setTimeout(() => {
    if (window.githubNoteManager.config.token) {
        console.log('Tokenå·²åŠ è½½');
    }
}, 1000);</code></pre>
    </div>

    <h2>ğŸ’» å®Œæ•´ç¤ºä¾‹</h2>

    <div class="step">
        <h3>ç¤ºä¾‹HTMLé¡µé¢</h3>
        <pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;è¯„è®ºé¡µé¢&lt;/title&gt;
    &lt;script src="github-api.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;åšå®¢è¯¦æƒ…&lt;/h1&gt;
    &lt;div id="noteContent"&gt;...&lt;/div&gt;

    &lt;div id="commentSection"&gt;
        &lt;h2&gt;å‘è¡¨è¯„è®º&lt;/h2&gt;
        &lt;form id="commentForm"&gt;
            &lt;input type="text" id="author" placeholder="æ˜µç§°ï¼ˆå¯é€‰ï¼‰"&gt;
            &lt;textarea id="content" placeholder="è¯„è®ºå†…å®¹" required&gt;&lt;/textarea&gt;
            &lt;button type="submit"&gt;å‘è¡¨è¯„è®º&lt;/button&gt;
        &lt;/form&gt;
    &lt;/div&gt;

    &lt;script&gt;
        // 1. é…ç½®åŠ å¯†token
        window.setupEncryptedToken({
            token: "åŠ å¯†çš„token",
            salt: "åŠ å¯†çš„ç›å€¼",
            iterations: 100000
        });

        // 2. ç­‰å¾…tokenåŠ è½½å®Œæˆåå¯ç”¨è¡¨å•
        window.addEventListener('tokenLoaded', () => {
            console.log('âœ… TokenåŠ è½½å®Œæˆï¼Œå¯ä»¥è¯„è®º');
            document.getElementById('commentForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const author = document.getElementById('author').value || 'åŒ¿åç”¨æˆ·';
                const content = document.getElementById('content').value;
                // ä½¿ç”¨è‡ªåŠ¨åŠ è½½çš„token
                const comment = {
                    id: `comment-${Date.now()}`,
                    noteId: 'note-001',
                    author,
                    content,
                    date: new Date().toISOString()
                };
                await window.githubNoteManager.saveComment(comment);
                alert('è¯„è®ºå‘è¡¨æˆåŠŸï¼');
            });
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
    </div>

    <h2>ğŸ”’ å®‰å…¨å»ºè®®</h2>

    <div class="success">
        <h3>âœ… æœ€ä½³å®è·µ</h3>
        <ul>
            <li>Tokenæƒé™ä»…å…è®¸ <strong>å†™å…¥notes/ç›®å½•</strong></li>
            <li>è®¾ç½®token <strong>90å¤©è¿‡æœŸ</strong></li>
            <li>ä½¿ç”¨ <strong>Fine-grained tokens</strong></li>
            <li>å®šæœŸ <strong>ç›‘æ§å’Œå®¡è®¡</strong> tokenä½¿ç”¨</li>
            <li>å‡†å¤‡ <strong>å¿«é€Ÿæ’¤é”€</strong> æœºåˆ¶</li>
        </ul>
    </div>

    <h2>ğŸ› ï¸ é…ç½®ç»†åŒ–æƒé™</h2>

    <div class="step">
        <h3>GitHub Fine-grained Tokenæƒé™è®¾ç½®</h3>
        <p>åœ¨GitHubåˆ›å»ºtokenæ—¶ï¼Œç¡®ä¿ï¼š</p>
        <ul>
            <li><strong>Repository access:</strong> Only select repositories</li>
            <li><strong>Repository permissions:</strong>
                <ul>
                    <li>Contents: Read and Write</li>
                    <li>Metadata: Read</li>
                </ul>
            </li>
            <li><strong>Account permissions:</strong> None</li>
        </ul>
    </div>

    <h2>ğŸ“Š ç›‘æ§tokenä½¿ç”¨</h2>

    <div class="step">
        <h3>GitHubå®¡è®¡æ—¥å¿—</h3>
        <p>åœ¨GitHubä»“åº“çš„Settings > Security > Audit logä¸­æŸ¥çœ‹ï¼š</p>
        <ul>
            <li>Tokenä½¿ç”¨è®°å½•</li>
            <li>æäº¤æ´»åŠ¨</li>
            <li>å¼‚å¸¸è®¿é—®</li>
        </ul>
    </div>

    <h2>ğŸš¨ å¦‚æœtokenæ³„éœ²</h2>

    <div class="warning">
        <h3>åº”æ€¥å¤„ç†æ­¥éª¤</h3>
        <ol>
            <li>ç«‹å³è®¿é—® <a href="https://github.com/settings/tokens" target="_blank">GitHub Tokenè®¾ç½®</a></li>
            <li>æ‰¾åˆ°å¹¶åˆ é™¤æ³„éœ²çš„token</li>
            <li>æ¸…ç†å¯èƒ½çš„æ¶æ„æäº¤</li>
            <li>é‡æ–°ç”Ÿæˆæ–°token</li>
            <li>æ›´æ–°å‰ç«¯åŠ å¯†é…ç½®</li>
            <li>åˆ†ææ³„éœ²åŸå› </li>
        </ol>
    </div>

    <h2>ğŸ’¡ æ›¿ä»£æ–¹æ¡ˆ</h2>

    <div class="step">
        <h3>æ›´å®‰å…¨çš„æ–¹æ¡ˆ</h3>
        <ul>
            <li><strong>ç”¨æˆ·è‡ªå·±é…ç½®tokenï¼š</strong>æœ€å®‰å…¨ï¼Œä½†ç”¨æˆ·ä½“éªŒç¨å·®</li>
            <li><strong>GitHub Appï¼š</strong>ä¼ä¸šçº§æ–¹æ¡ˆï¼Œæ”¯æŒå®¡è®¡å’Œç»†ç²’åº¦æƒé™</li>
            <li><strong>Server-sideä»£ç†ï¼š</strong>å‰ç«¯ä¸æ¥è§¦tokenï¼Œä½†éœ€è¦æœåŠ¡å™¨</li>
        </ul>
    </div>

    <h2>ğŸ“ æ€»ç»“</h2>

    <div class="success">
        <h3>ä½¿ç”¨åŠ å¯†tokençš„ä¼˜åŠ¿</h3>
        <ul>
            <li>âœ… ç”¨æˆ·æ— éœ€é…ç½®è‡ªå·±çš„token</li>
            <li>âœ… ç»Ÿä¸€çš„è¯„è®ºç³»ç»Ÿ</li>
            <li>âœ… ä¾¿äºç®¡ç†å’Œå®¡è®¡</li>
            <li>âš ï¸ éœ€è¦å¹³è¡¡ä¾¿åˆ©æ€§å’Œå®‰å…¨æ€§</li>
        </ul>
    </div>

    <hr style="margin: 40px 0; border: none; border-top: 2px solid #eee;">

    <p style="text-align: center; color: #666;">
        <strong>å»ºè®®ï¼š</strong>æ­¤æ–¹æ¡ˆé€‚åˆå…¬å¼€çš„ä¸ªäººåšå®¢æˆ–å°è§„æ¨¡åº”ç”¨ã€‚å¯¹äºå•†ä¸šæˆ–ä¼ä¸šçº§åº”ç”¨ï¼Œå»ºè®®ä½¿ç”¨æ›´å®‰å…¨çš„ä¼ä¸šæ–¹æ¡ˆã€‚
    </p>
</body>
</html>
